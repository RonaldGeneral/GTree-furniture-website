<!DOCTYPE html>
<html>
    <head>
        <script src="/fixed-layout/fixed-layout.js" type="text/javascript"></script>
        <script>head("Checkout");</script>
        <style>
            article{
                padding: 5px;
            }
            
            h1,h3{
                text-align: center;
            }
            h1{
                font-size: 30px;
            }
            h2, h3{
                font-size: 20px;
            }

            table, th, td {
                border: 1px solid black;
                border-collapse: collapse;
                padding:10px;
                text-align: center;
                table-layout: auto;
                margin-left: auto;
                margin-right: auto;
                min-width: 80%;
                
            }
            td{
                word-wrap:break-word;
                word-break: break-all;
            }

            ul.personal-details>li:nth-of-type(1){
                list-style-image: url(checkout-assets/people.png);
            }
            ul.personal-details>li:nth-of-type(2){
                list-style-image: url(checkout-assets/home.png);
            }
            ul.personal-details>li:nth-of-type(3){
                list-style-image: url(checkout-assets/phone-call.png);
            }
            ul.personal-details>li:nth-of-type(4){
                list-style-image: url(checkout-assets/send-email.png);
            }

            /*personal details layout*/
            .personal-details label{
                width: 200px;
                float: left;
            }
            .personal-details input, .personal-details textarea{
                width: 80%;
                padding: 5px;
            }
            .info{
                margin: 10px;
            }

            /*payment and place order button design*/
            #payment-method{
                display: flex;
                flex-flow: row wrap;
                justify-content:space-evenly;
            }
            
            #payment-method button{
                max-width: 350px;
                height: auto;
                margin: 10px;
                flex: 1 1 200px;
            }
            
            #place-order{
                display: flex;
                flex-flow: row wrap;
                justify-content:end;
                align-items: center;
            }
            #place-order button{
                margin: 10px;
                padding: 50px;
                font-size: 25px;
            }
            #place-order p{
                font-size: 30px; 
                margin: 0px; 
                padding:10px; 
            }
        </style>
    </head>
    <body>
        <script>body();</script>
        <!--Content part-->
        <article>
            
        <h1 style="text-align: center;font-weight: bold;">Check Out</h1>
        <h2>Delivery Details</h2>
        <form class="personal-details">
            <div class="info">
            <label for="name"><img src="checkout-assets/people.png"> Name: </label>
            <input type="text" id="name" name="name"  required/>
            </div>
            <div class="info">
            <label for="address"><img src="checkout-assets/home.png"> Address: </label>
            <textarea id="address" name="address" rows="3" cols="1" required></textarea>
            </div>
            <div class="info">
            <label for="phone"><img src="checkout-assets/phone-call.png"> Phone Number: </label>
            <input type="tel" id="phone" name="phone" required/>
            </div>
            <div class="info">
            <label for="email"><img src="checkout-assets/send-email.png"> Email: </label>
            <input type="email" id="email" name="email" required/>
            </div>
        </form>
        
        <h3 style="text-decoration-line: underline;">Summary of Order</h3>
        <table id="summary-table">
            <tr>
                <th>Products</th>
                <th>Unit Price (RM)</th>
                <th>Quantity</th>
                <th>Price (RM)</th>
            </tr>
            <script>
                
                /*Storage.prototype.setObj = function(key, obj) {
                                return this.setItem(key, JSON.stringify(obj))
                            }
                localStorage.setObj("selectedProduct", ["chair", "table"]);
                localStorage.setObj("selectedUnitPrice", [200.12, 500.23]);
                localStorage.setObj("selectedQty", [3,5]);
                localStorage.setObj("selectedPrice", [600.23, 4]);*/


                //retrieve data from local storage
                Storage.prototype.getObj = function(key) {
                    return JSON.parse(this.getItem(key))
                }
                var product = localStorage.getObj("selectedProduct");
                var unitPrice = localStorage.getObj("selectedUnitPrice");
                var qty = localStorage.getObj("selectedQty");
                var price = localStorage.getObj("selectedPrice");
                var sum = 0;

                //print the data to the webpage
                for (var i = 0; i < product.length; i++)
                {
                    document.write(
                    "<tr>" +
                    "<td>" + product[i] + "</td>" +
                    "<td>" + unitPrice[i] + "</td>" +
                    "<td>" + qty[i] + "</td>" +
                    "<td>" + price[i] + "</td>" +
                    "</tr>");
                    sum += price[i];
                }
                //add shipping fee to the price if the total is less than RM1000.00
                if (sum < 1000.00)
                {
                    sum += 5;
                    document.write(
                    "<tr>" +
                    '<td colspan="3" style="text-align: right;">Shipping Fee (RM):</td>' +
                    "<td>" + '5.00' + "</td>" +
                    "</tr>");
                }
                //output the total price        
                document.write(
                    "<tr>" +
                    '<td colspan="3" style="text-align: right;">Total Price (RM):</td>' +
                    "<td>" + sum + "</td>" +
                "</tr>"
                );




                //payment button programming
                var payment = "";
                //change the background color according to user's choice
                function select(type){
                    var choice = document.body.getElementsByClassName("choice");
                    choice[0].style.backgroundColor = "rgb(239,239,239)";
                    choice[1].style.backgroundColor = "rgb(239,239,239)";
                    choice[2].style.backgroundColor = "rgb(239,239,239)";
                    choice[3].style.backgroundColor = "rgb(239,239,239)";
                    choice[type].style.backgroundColor = "rgb(91, 151, 255)";
                    payment = choice[type].innerText;
                }


                //place order button programming
                //store the personal information to local storage
                function invoice(){
                    var name = document.getElementById("name").value;
                    var address = document.getElementById("address").value;
                    var phone = document.getElementById("phone").value;
                    var email = document.getElementById("email").value;
                    
                //check validity of personal information
                if (name != "" && address != "" && phone != "" && email != "")
                {
                    if(payment != "")
                    {
                        localStorage.setItem("name", name);
                        localStorage.setItem("address", address);
                        localStorage.setItem("phone", phone);
                        localStorage.setItem("email", email);
                        localStorage.setItem("payment-method", payment);

                        window.location.assign("invoice.html");
                    }
                    else
                    alert("Please choose the payment method");
                }
                else
                    alert("Please complete your personal inforamtion");
                    
                }
            </script>
        </table>
        
        <p>*All products are delivered in standard delivery</p>
        <h3 style="text-decoration: underline;">Payment Method</h3>
        <div id="payment-method">
            <button class="choice" onclick="select(0)"><img style="width: 70px; height: auto;" src="checkout-assets/touch-n-go.png"><p>Touch 'n Go eWallet</p></button>
            <button class="choice" onclick="select(1)"><img style="width: 300px; height: auto;" src="checkout-assets/online-banking.png"><p>Online Banking</p></button>
            <button class="choice" onclick="select(2)"><img style="width: 150px; height: auto;" src="checkout-assets/credit-card.png"><p>Credit / Debit Card</p></button>
            <button class="choice" onclick="select(3)"><img style="width: 100px; height: auto;" src="checkout-assets/installment.png"><p>Installment</p></button>
        </div>
        <div id="place-order">
        <p>Total: RM</p>
        <button onclick="invoice()">Place Order</button>
        </div>
        
    </article>
    
      <script>footer();</script>
</body>
</html>